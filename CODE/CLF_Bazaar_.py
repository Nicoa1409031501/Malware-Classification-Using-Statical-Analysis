import os
import glob
import shutil
import openpyxl



#####################################################################
'''
This is the head of the code
'''
#####################################################################
if __name__=='__main__':
    print()


    wb=openpyxl.Workbook()
    wb.active
    sheet = wb.worksheets[0]
    sample_path="/media/cape/qe/Bazaar/classified/*"
    list=[]
    count=0
    for i in glob.iglob(sample_path):
        print(i)
        initial_count = 0
        for path in os.listdir(i):
            if os.path.isfile(os.path.join(i, path)):
                initial_count += 1
        print(initial_count)
        count+=initial_count
        log=[os.path.basename(i),str(initial_count)]
        sheet.append(log)
    print(count)
    wb.save('Bazaar.xlsx')
#####################################################################
'''
以下是分類
'''
'''    sample_path="/media/cape/qe/Bazaar/Malware_sample_Bazaar_unzip/*"
    list=[]
    count=0
    for i in glob.iglob(sample_path):
        name=os.path.basename(i)
        count+=1
        #print(i)

        #print('/media/cape/qe/Bazaar/classified/'+i.split('.',)[1])
        if i.split('.',)[1] not in list:
            list.append(i.split('.',)[1])
            #os.makedirs('/media/cape/qe/Bazaar/classified/'+i.split('.',)[1], mode=0o777)
        else:
            print("ww")
        #os.rename(i,'/media/cape/qe/Bazaar/classified/'+i.split('.',)[1]+"/"+os.path.basename(i))
        #print(i)
        #print('/media/cape/qe/Bazaar/classified/'+i.split('.',)[1]+"/"+os.path.basename(i))
    print(list)
    print(count)
    print(len(list))'''