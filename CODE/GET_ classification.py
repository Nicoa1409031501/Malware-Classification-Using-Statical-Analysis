import os
import glob
import json
import openpyxl
#####################################################################
'''
This is the head of the code
'''
#####################################################################
Mamba_sample_path="/home/cape/Documents/mamba_dataset/MAMBA_dataset/*"
Dike_sample_path="/home/cape/Documents/DikeDataset-main/files/malware/*"
save_path_dike='/home/cape/Documents/Dataset/png_dike/'
save_path_mamba='/home/cape/Documents/Dataset/png_mamba/'
mail_path='/media/cape/qe/malimg_paper_dataset_imgs/*'
List_path='/media/cape/qe/Bazaar/List'
malimg_reports_path='/media/cape/12TB_HDD/Reports/Reports_Malimg/*'

file_source = '/media/cape/12TB_HDD/Reports/Reports_Malimg'
file_destination = '/media/cape/12TB_HDD/Reports/Reports_Malimg'

if __name__=='__main__':
    wb=openpyxl.Workbook()
    wb.active
    sheet=wb.worksheets[0]
    countyes=0
    counttotal=0
    compare=[]
    compare2=[]
    for b in glob.iglob('/media/cape/12TB_HDD/Reports/Reports_Dike/*'):
        print(b)
        with open(b)as read:
            file=json.load(read)
            try:
                classification=file['data']['attributes']['last_analysis_results']['Microsoft']['result']
                classs=str(classification).split('/',)[1]
                print(classs)
                if classs not in compare:
                    compare.append(classs)
                if classs.split('.',)[0] not in compare2:
                    compare2.append(classs.split('.',)[0])
            except:
                12
                #compare.append("Fail")
    print(len(compare))
    print(compare)
    print(len(compare2))
    print(compare2)
    

'''
if __name__=='__main__':
    wb=openpyxl.Workbook()
    wb.active
    sheet=wb.worksheets[0]
    countyes=0
    counttotal=0
    compare=[]
    for a in glob.iglob(file_destination+'/*'):
        #compare.append(os.path.basename(a))
        compare_name=os.path.basename(a)
        for b in glob.iglob(a+'/*'):
            print(b)
            counttotal+=1
            with open(b)as read:
                file=json.load(read)
                try:
                    classification=file['data']['attributes']['last_analysis_results']['Microsoft']['result']
                    classs=str(classification).split('/',)[1]
                    if compare_name == classs:
                        countyes+=1
                    print(classs)
                    if classs not in compare:
                        compare.append(classs)
                except:
                    12
                #compare.append("Fail")
    print(len(compare))
    print(compare)
    print(countyes)
    print(counttotal)

'''
            #print(b)'''
'''

    for i in glob.iglob(malimg_reports_path):
        name=os.path.basename(i)
        #Setting the origin location of the samples
        with open(i)as read:
            file=json.load(read)
            try:
                classification=file['data']['attributes']['popular_threat_classification']['suggested_threat_label']
                if classification not in compare:
                    compare.append(classification)
            except:
                12
                #compare.append("Fail")
    for k in compare:
        print(k,":",compare.count(k))
    #print(compare)'''
