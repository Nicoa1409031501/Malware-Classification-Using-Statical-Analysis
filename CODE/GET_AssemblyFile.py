import os
import glob
import r2pipe
import openpyxl
Mamba_sample_path="/home/cape/Documents/mamba_dataset/MAMBA_dataset/*"
Dike_sample_path="/home/cape/Documents/DikeDataset-main/files/malware/*"
Bytes_path="/home/cape/Documents/DikeDataset-main/files/Bytes/*"
for i in glob.iglob('/home/cape/Downloads/*'):
    filename=os.path.basename(i)
    r=r2pipe.open(i)
    r.cmd('aaaa')
    r.cmd('iS')
    r.cmd('afl')
    assembly_code_section=r.cmd('afl').splitlines(True)
    with open('/home/cape/Documents/'+filename+'.asm','w') as file_write:
        for j in assembly_code_section:
            section_address=j.split(' ',2)[0]
            r.cmd(section_address)
            assembly_code=r.cmd('pdr')
            file_write.write(assembly_code)

'''
for i in glob.iglob(Dike_sample_path):
    filename=str(i.split("/")[7])
    r=r2pipe.open(i)
    r.cmd('-qq aaaa')
    r.cmd('iS')
    r.cmd('afl')
    assembly_code_section=r.cmd('afl').splitlines(True)
    with open('/home/cape/Documents/DikeDataset-main/files/assembly_r2/'+filename+'.asm','w') as file_write:
        for j in assembly_code_section:
            section_address=j.split(' ',2)[0]
            r.cmd(section_address)
            assembly_code=r.cmd('pdr')
            file_write.write(assembly_code)
    asm_file_size=os.path.getsize('/home/cape/Documents/DikeDataset-main/files/assembly_r2/'+filename+'.asm')
'''

