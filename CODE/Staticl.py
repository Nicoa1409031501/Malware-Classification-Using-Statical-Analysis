import os
import glob
import openpyxl
import statistics
os.chdir("/home/cape/Documents")
# 利用 Workbook 建立一個新的工作簿
workbook = openpyxl.Workbook()

# 取得第一個工作表
sheet = workbook.worksheets[0]

sample_path="/home/cape/Documents/DikeDataset-main/files/malware/*"
Bytes_path="/home/cape/Documents/DikeDataset-main/files/Bytes/*"
log=["SHA","FileSize","objdump or not?"]
sheet.append(log)
ii=0
sizeadd=0
sizelist=[]
for i in glob.iglob(sample_path):
    ii+=1
    '''
    
    with open(i, 'rb') as fr:
            contents = fr.read()
            counter=0
            for single_character in contents:
                counter+=1'''
    #print(os.path.getsize(i))
    print(ii)
    sizeadd+=os.path.getsize(i)
    sizelist.append(os.path.getsize(i))
#objdump successful or not 
    obj_file_path="/home/cape/Documents/DikeDataset-main/files/assembly/"+str(i.split("/")[7])+".asm"
    if os.path.getsize(obj_file_path) != 0 :
        objresult="success"
    else:
        objresult="fail"
#log=[str(i.split("/")[7]),str(os.path.getsize(i)),str(counter)]
#讀取完後把東西存進log輸入進excel
    log=[str(i.split("/")[7]),str(os.path.getsize(i)),objresult]
    sheet.append(log)

mean=sizeadd/10841
print(mean)
print(statistics.quantiles(sizelist,n=4, method='inclusive'))
sheet.append([mean])
sheet.append(statistics.quantiles(sizelist,n=4, method='inclusive'))
workbook.save('Dike_dataset_filesize.xlsx')
print("Done!")